--Table List
SELECT
DBS.DB_ID,
DBS.NAME,
TBLS.TBL_ID,
TBLS.TBL_NAME,
TBLS.TBL_TYPE,
TBLS.OWNER
FROM TBLS
LEFT JOIN DBS ON TBLS.DB_ID=DBS.DB_ID
LEFT JOIN SDS ON TBLS.SD_ID=SDS.SD_ID
WHERE TBLS.TBL_NAME='stg_adways_qsi'
AND TBLS.TBL_TYPE='MANAGED_TABLE'
AND SDS.INPUT_FORMAT<>'org.apache.kudu.mapreduce.KuduTableInputFormat'


--Columns
SELECT
DBS.DB_ID,
DBS.NAME,
TBLS.TBL_ID,
TBLS.TBL_NAME,
TBLS.TBL_TYPE,
TBLS.OWNER,
COLUMNS_V2.CD_ID,
COLUMNS_V2.COLUMN_NAME,
COLUMNS_V2.TYPE_NAME,
COLUMNS_V2.INTEGER_IDX
FROM TBLS
LEFT JOIN DBS ON TBLS.DB_ID=DBS.DB_ID
LEFT JOIN SDS ON TBLS.SD_ID=SDS.SD_ID
LEFT JOIN COLUMNS_V2 ON SDS.CD_ID=COLUMNS_V2.CD_ID
WHERE TBLS.TBL_NAME='stg_adways_qsi'
AND TBLS.TBL_TYPE='MANAGED_TABLE'
AND SDS.INPUT_FORMAT<>'org.apache.kudu.mapreduce.KuduTableInputFormat'
ORDER BY COLUMNS_V2.INTEGER_IDX


--Partition
SELECT
DBS.DB_ID,
DBS.NAME,
TBLS.TBL_ID,
TBLS.TBL_NAME,
PARTITION_KEYS.PKEY_NAME,
PARTITION_KEYS.PKEY_TYPE,
PARTITION_KEYS.INTEGER_IDX
FROM TBLS
LEFT JOIN DBS ON TBLS.DB_ID=DBS.DB_ID
LEFT JOIN SDS ON TBLS.SD_ID=SDS.SD_ID
LEFT JOIN PARTITION_KEYS ON TBLS.TBL_ID=PARTITION_KEYS.TBL_ID
WHERE TBLS.TBL_NAME='stg_adways_qsi'
AND TBLS.TBL_TYPE='MANAGED_TABLE'
AND SDS.INPUT_FORMAT<>'org.apache.kudu.mapreduce.KuduTableInputFormat'
ORDER BY PARTITION_KEYS.INTEGER_IDX


--SERDE and Store and Location
SELECT
DBS.DB_ID,
DBS.NAME,
TBLS.TBL_ID,
TBLS.TBL_NAME,
SERDES.SLIB,
SDS.INPUT_FORMAT,
SDS.OUTPUT_FORMAT
FROM TBLS
LEFT JOIN DBS ON TBLS.DB_ID=DBS.DB_ID
LEFT JOIN SDS ON TBLS.SD_ID=SDS.SD_ID
LEFT JOIN SERDES ON SDS.SERDE_ID=SERDES.SERDE_ID
WHERE TBLS.TBL_NAME='stg_adways_qsi'
AND TBLS.TBL_TYPE='MANAGED_TABLE'
AND SDS.INPUT_FORMAT<>'org.apache.kudu.mapreduce.KuduTableInputFormat'